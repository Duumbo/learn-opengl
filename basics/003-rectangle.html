<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Rectangle Elements - Learn OpenGL Rust</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="A version of the LearnOpenGL book for Rust.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../introduction.html">Introduction</a></li><li class="chapter-item expanded "><a href="../basics/index.html"><strong aria-hidden="true">1.</strong> Basics</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../basics/000-creating-a-window.html"><strong aria-hidden="true">1.1.</strong> Creating A Window</a></li><li class="chapter-item expanded "><a href="../basics/001-drawing-a-triangle.html"><strong aria-hidden="true">1.2.</strong> Drawing A Triangle</a></li><li class="chapter-item expanded "><a href="../basics/002-triangle-cleanup.html"><strong aria-hidden="true">1.3.</strong> Triangle Cleanup</a></li><li class="chapter-item expanded "><a href="../basics/003-rectangle.html" class="active"><strong aria-hidden="true">1.4.</strong> Rectangle Elements</a></li></ol></li><li class="chapter-item expanded "><a href="../appendix-math/index.html"><strong aria-hidden="true">2.</strong> Appendix: Math</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../appendix-math/vectors.html"><strong aria-hidden="true">2.1.</strong> Vectors</a></li><li class="chapter-item expanded "><a href="../appendix-math/matrices.html"><strong aria-hidden="true">2.2.</strong> Matrices</a></li><li class="chapter-item expanded "><a href="../appendix-math/transform.html"><strong aria-hidden="true">2.3.</strong> Transforms</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Learn OpenGL Rust</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="rectangle-elements"><a class="header" href="#rectangle-elements">Rectangle Elements</a></h1>
<p>Naturally we don't want just one triangle. When you're playing The Witcher 3,
there's at least two triangles on the screen (maybe more!).</p>
<p>Let's move on to drawing a rectangle. For this we need a second triangle.</p>
<p>We could just add three more vertex entries and call it a day. If we wanted two
triangles that were each on their own that's what we might do. However, since
these two triangles making up our rectangle are going to be directly touching,
that means we'd have six vertexes making up only four &quot;real&quot; points. That's 50%
more space used than we want! It may seem small now, but a complete model for a
tree or a person or something like that can easily end up being thousands of
triangles. Making that be 50% more space used is a bad time.</p>
<p>Of course this problem of duplicate vertices is a fairly easy problem to solve,
and GL has it covered. What we do is specify an <a href="https://www.khronos.org/opengl/wiki/Vertex_Specification#Index_buffers">Index
Buffer</a>.
It holds the indexes of the vertex buffer entries we want to use to form each
geometry element (in this case triangles). Then the vertex buffer doesn't need
to have any duplicates, we just have more than one triangle index the same
vertex.</p>
<p>Note: What we'll be drawing is usually called a &quot;quad&quot;, because the important
part is that it has four outside edges. It's not really important that the edges
are in two pairs of parallel lines at right angles with each other like a true
rectangle has.</p>
<h2 id="data"><a class="header" href="#data">Data</a></h2>
<p>So we've got some new data. We're going to have 4 vertex entries that describes
the points we want to use, and an index buffer with 2 entries where each entry
describes a triangle using the points.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>type Vertex = [f32; 3];
type TriIndexes = [u32; 3];

const VERTICES: [Vertex; 4] =
  [[0.5, 0.5, 0.0], [0.5, -0.5, 0.0], [-0.5, -0.5, 0.0], [-0.5, 0.5, 0.0]];

const INDICES: [TriIndexes; 2] = [[0, 1, 3], [1, 2, 3]];
<span class="boring">}</span></code></pre></pre>
<h2 id="element-buffer-object"><a class="header" href="#element-buffer-object">Element Buffer Object</a></h2>
<p>Our indexes go into a separate kind of buffer. This is that <code>ElementArray</code>
buffer type that I snuck into the cleanup lesson.</p>
<p>After we make and bind our vertex data we also bind a buffer for the element
data and upload it, the code looks nearly identical:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let ebo = Buffer::new().expect(&quot;Couldn't make the element buffer.&quot;);
ebo.bind(BufferType::ElementArray);
learn::buffer_data(
  BufferType::ElementArray,
  bytemuck::cast_slice(&amp;INDICES),
  GL_STATIC_DRAW,
);
<span class="boring">}</span></code></pre></pre>
<h2 id="draw-it"><a class="header" href="#draw-it">Draw It!</a></h2>
<p>Finally, instead of calling <code>glDrawArrays</code>, we use a separate function called <a href="https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glDrawElements.xhtml"><code>glDrawElements</code></a>.</p>
<ul>
<li><code>mode</code>: The style of drawing. We're still drawing triangles so we keep that
from before.</li>
<li><code>count</code>: The number of index elements to draw. We want two triangles to form
our quad, and there's three indexes per triangle, so we put 6.</li>
<li><code>type</code>: This is the type of the index data. The <code>u32</code> type is specified with
<code>GL_UNSIGNED_INT</code>. I used <code>u32</code> out of habit, we could have made our indexes
be <code>u16</code> or <code>u8</code> as well.</li>
<li><code>indices</code>: is a pointer to the position within the index buffer to start the
drawing with. Similar to the attribute specification, you pretend the index
buffer starts at address 0 and then you decide the offset you want, and then
cast that to a <code>*const</code> pointer.</li>
</ul>
<p>So the usage looks like this:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// and then draw!
unsafe {
  glClear(GL_COLOR_BUFFER_BIT);
  glDrawElements(GL_TRIANGLES, 6, GL_UNSIGNED_INT, 0 as *const _);
}
win.swap_window();
<span class="boring">}</span></code></pre></pre>
<h2 id="bonus-wireframe-mode"><a class="header" href="#bonus-wireframe-mode">Bonus: Wireframe Mode</a></h2>
<p>Since this lesson is really short let's look at one extra ability we can use.</p>
<p>You often see 3d models with just the outlines of each triangle. &quot;Wireframe
mode&quot; it's sometimes called. We can easily do that with
<a href="https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glPolygonMode.xhtml"><code>glPolygonMode</code></a>.</p>
<ul>
<li>We can specify the <code>face</code>, but in the Core profile the only valid value is
<code>GL_FRONT_AND_BACK</code> (in Compatibility profile you can also use <code>GL_FRONT</code> or
<code>GL_BACK</code>).</li>
<li>We also specify the <code>mode</code>. The default is <code>GL_FILL</code>, but With <code>GL_LINE</code> we
get the wireframe effect. <code>GL_POINT</code> is also allowed, but makes it pretty hard
to see what's going on.</li>
</ul>
<p>All this can go in our <code>lib.rs</code> file:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>/// The polygon display modes you can set.
#[derive(Debug, Clone, Copy, PartialEq, Eq)]
pub enum PolygonMode {
  /// Just show the points.
  Point = GL_POINT as isize,
  /// Just show the lines.
  Line = GL_LINE as isize,
  /// Fill in the polygons.
  Fill = GL_FILL as isize,
}

/// Sets the font and back polygon mode to the mode given.
pub fn polygon_mode(mode: PolygonMode) {
  unsafe { glPolygonMode(GL_FRONT_AND_BACK, mode as GLenum) };
}
<span class="boring">}</span></code></pre></pre>
<p>And then before our main loop we can turn it on:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>learn::polygon_mode(PolygonMode::Line);
<span class="boring">}</span></code></pre></pre>
<p>Now we get a wireframe quad! and it looks like two triangles just like it should!</p>
<h2 id="done"><a class="header" href="#done">Done!</a></h2>
<ul>
<li>Code <a href="https://github.com/rust-tutorials/learn-opengl/blob/master/examples/003-rectangle-elements.rs">003-rectangle-elements</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../basics/002-triangle-cleanup.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../appendix-math/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../basics/002-triangle-cleanup.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../appendix-math/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
